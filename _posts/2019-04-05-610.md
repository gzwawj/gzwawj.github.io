---
layout: post
title:  PHP使二维数组结构转换为树状结构
date:   2019/04/05 14:45
categories:   程序开发
tags: 数据结构 php 
excerpt: 根据公司的业务，使用php对二维数组进行循环，最终得到树状结构的数据，以下是主要的实现方法  测试数据  数据源：（数据要求一维key与对应value二维数组的id要一样）  $items = array(     1 =&gt; array('id' =&gt; 1, 'pid' =&gt; 0, 'name' =&gt; '江西省'),     2 =&gt; array('id' =&gt;
comment: true
---
* content
{:top}

根据公司的业务，使用php对二维数组进行循环，最终得到树状结构的数据，以下是主要的实现方法

<h2>测试数据</h2>

数据源：（数据要求一维key与对应value二维数组的id要一样）

<pre><code class="language-php ">$items = array(
    1 =&gt; array('id' =&gt; 1, 'pid' =&gt; 0, 'name' =&gt; '江西省'),
    2 =&gt; array('id' =&gt; 2, 'pid' =&gt; 0, 'name' =&gt; '黑龙江省'),
    3 =&gt; array('id' =&gt; 3, 'pid' =&gt; 1, 'name' =&gt; '南昌市'),
    4 =&gt; array('id' =&gt; 4, 'pid' =&gt; 2, 'name' =&gt; '哈尔滨市'),
    5 =&gt; array('id' =&gt; 5, 'pid' =&gt; 2, 'name' =&gt; '鸡西市'),
    6 =&gt; array('id' =&gt; 6, 'pid' =&gt; 4, 'name' =&gt; '香坊区'),
    7 =&gt; array('id' =&gt; 7, 'pid' =&gt; 4, 'name' =&gt; '南岗区'),
    8 =&gt; array('id' =&gt; 8, 'pid' =&gt; 6, 'name' =&gt; '和兴路'),
    9 =&gt; array('id' =&gt; 9, 'pid' =&gt; 7, 'name' =&gt; '西大直街'),
    10 =&gt; array('id' =&gt; 10, 'pid' =&gt; 8, 'name' =&gt; '东北林业大学'),
    11 =&gt; array('id' =&gt; 11, 'pid' =&gt; 9, 'name' =&gt; '哈尔滨工业大学'),
    12 =&gt; array('id' =&gt; 12, 'pid' =&gt; 8, 'name' =&gt; '哈尔滨师范大学'),
    13 =&gt; array('id' =&gt; 13, 'pid' =&gt; 1, 'name' =&gt; '赣州市'),
    14 =&gt; array('id' =&gt; 14, 'pid' =&gt; 13, 'name' =&gt; '赣县'),
    15 =&gt; array('id' =&gt; 15, 'pid' =&gt; 13, 'name' =&gt; '于都县'),
    16 =&gt; array('id' =&gt; 16, 'pid' =&gt; 14, 'name' =&gt; '茅店镇'),
    17 =&gt; array('id' =&gt; 17, 'pid' =&gt; 14, 'name' =&gt; '大田乡'),
    18 =&gt; array('id' =&gt; 18, 'pid' =&gt; 16, 'name' =&gt; '义源村'),
    19 =&gt; array('id' =&gt; 19, 'pid' =&gt; 16, 'name' =&gt; '上坝村'),
);
</code></pre>

<h2>获取树状结构</h2>

<pre><code class="language-php ">function getTree($items) {
    $tree = array();
    foreach ($items as $item)
        if (isset($items[$item['pid']]))
            $items[$item['pid']]['son'][] = &amp;$items[$item['id']];
        else
            $tree[] = &amp;$items[$item['id']];
    return $tree;
}
</code></pre>

<h2>让我们精简一下代码</h2>

<pre><code class="language-php "><br />function getTree($items) {
    foreach ($items as $item)
        $items[$item['pid']]['son'][$item['id']] = &amp;$items[$item['id']];
    return isset($items[0]['son']) ? $items[0]['son'] : array();
}
</code></pre>

一遍循环，使用内存引用。省时又省空间。
    